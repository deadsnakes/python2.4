From: Felix Krull <f_krull@gmx.de>
Date: Fri, 27 Apr 2018 08:06:22 -0700
Subject: CVE-2009-3560

## CVE-2009-3560.dpatch by Jamie Strandboge <jamie@ubuntu.com>
##
## Description: DoS via XML document with malformed UTF-8 sequences
##  (CVE_2009_3560)
## Origin: http://expat.cvs.sourceforge.net/viewvc/expat/expat/lib/xmlparse.c?r1=1.164&r2=1.166
##  http://expat.cvs.sourceforge.net/viewvc/expat/expat/lib/xmlparse.c?view=log#rev1.166
##  http://expat.cvs.sourceforge.net/viewvc/expat/expat/lib/xmlparse.c?view=log#rev1.165
---
 Modules/expat/xmlparse.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/Modules/expat/xmlparse.c b/Modules/expat/xmlparse.c
index 388dff8..3bd9186 100644
--- a/Modules/expat/xmlparse.c
+++ b/Modules/expat/xmlparse.c
@@ -3617,6 +3617,9 @@ doProlog(XML_Parser parser,
         return XML_ERROR_UNCLOSED_TOKEN;
       case XML_TOK_PARTIAL_CHAR:
         return XML_ERROR_PARTIAL_CHAR;
+      case -XML_TOK_PROLOG_S:
+        tok = -tok;
+        break;
       case XML_TOK_NONE:
 #ifdef XML_DTD
         /* for internal PE NOT referenced between declarations */
