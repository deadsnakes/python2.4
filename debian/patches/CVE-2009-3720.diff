From: Felix Krull <f_krull@gmx.de>
Date: Fri, 27 Apr 2018 08:06:22 -0700
Subject: CVE-2009-3720

## CVE-2009-3720.dpatch by Jamie Strandboge <jamie@ubuntu.com>
##
## Description: DoS via malformed XML (CVE-2009-3720)
## Origin: http://expat.cvs.sourceforge.net/viewvc/expat/expat/lib/xmltok_impl.c?r1=1.15&r2=1.13
---
 Modules/expat/xmltok_impl.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/Modules/expat/xmltok_impl.c b/Modules/expat/xmltok_impl.c
index 46569fe..f3e0e52 100644
--- a/Modules/expat/xmltok_impl.c
+++ b/Modules/expat/xmltok_impl.c
@@ -1741,7 +1741,7 @@ PREFIX(updatePosition)(const ENCODING *enc,
                        const char *end,
                        POSITION *pos)
 {
-  while (ptr != end) {
+  while (ptr < end) {
     switch (BYTE_TYPE(enc, ptr)) {
 #define LEAD_CASE(n) \
     case BT_LEAD ## n: \
